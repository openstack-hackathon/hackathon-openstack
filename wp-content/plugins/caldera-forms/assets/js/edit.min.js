function new_conditional_group(e){var a=e.trigger.data("id"),i="cl"+Math.round(18746582734*Math.random()),t="rw"+Math.round(98347598345*Math.random()),o=[{id:t,type:e.trigger.data("type"),lines:[{id:i}]}];return{group:o,id:a}}function new_conditional_line(e){var a=e.trigger.data("id"),i=e.trigger.data("group"),t=e.trigger.data("type"),o="cl"+Math.round(18746582734*Math.random()),r={id:a,type:t,lineid:o,rowid:i,name:"config["+t+"]["+a+"][conditions][group]["+i+"]["+o+"]"};return r}function build_conditions_config(e){var a=JSON.parse(e.trigger.val());return a.id=e.trigger.data("id"),a}function setup_field_type(e){return{id:e.trigger.prop("id")}}function check_required_bindings(e){var a,i=(jQuery(".caldera-header-save-button"),jQuery(".layout-form-field")),t=jQuery(".caldera-processor-nav"),o=!0;a=e?jQuery(e):jQuery(".caldera-config-field .required"),a.removeClass("has-error"),i.removeClass("has-error"),t.removeClass("has-error"),jQuery(".error-tag").remove(),required_errors={},a.each(function(e,a){var i=jQuery(a),t=i.closest(".caldera-config-editor-panel");if(a.value.length){if(i.hasClass("field-slug"))for(var r=jQuery(".field-slug").not(i),l=0;l<r.length;l++)if(r[l].value===a.value){var i=jQuery(r[l]);required_errors[t.prop("id")]||(required_errors[t.prop("id")]=0);var n=i.closest(".caldera-editor-field-config-wrapper"),d=i.closest(".caldera-editor-processor-config-wrapper");n.length&&jQuery('.layout-form-field[data-config="'+n.prop("id")+'"]').addClass("has-error"),d.length&&jQuery("."+d.prop("id")).addClass("has-error"),required_errors[t.prop("id")]+=1,i.addClass("has-error"),o=!1;break}if(i.hasClass("toggle_value_field"))for(var s=i.closest(".caldera-config-group").find(".toggle_value_field").not(i),l=0;l<s.length;l++)if(s[l].value===a.value){var i=jQuery(s[l]);required_errors[t.prop("id")]||(required_errors[t.prop("id")]=0);var n=i.closest(".caldera-editor-field-config-wrapper"),d=i.closest(".caldera-editor-processor-config-wrapper");n.length&&jQuery('.layout-form-field[data-config="'+n.prop("id")+'"]').addClass("has-error"),d.length&&jQuery("."+d.prop("id")).addClass("has-error"),required_errors[t.prop("id")]+=1,i.addClass("has-error"),o=!1;break}}else{required_errors[t.prop("id")]||(required_errors[t.prop("id")]=0);var n=i.closest(".caldera-editor-field-config-wrapper"),d=i.closest(".caldera-editor-processor-config-wrapper");n.length&&jQuery('.layout-form-field[data-config="'+n.prop("id")+'"]').addClass("has-error"),d.length&&jQuery("."+d.prop("id")).addClass("has-error"),required_errors[t.prop("id")]+=1,i.addClass("has-error"),o=!1}});for(var r in required_errors)jQuery(".caldera-forms-options-form").find('a[href="#'+r+'"]').append('<span class="error-tag">'+required_errors[r]+"</span>");return jQuery(".caldera-conditional-field-set").trigger("change"),o}jQuery(document).ready(function(e){function a(a){var t=e(a),o=t.closest(".caldera-editor-field-config-wrapper"),r=o.find(".caldera-config-field-setup"),l=compiled_templates[t.val()+"_tmpl"]?compiled_templates[t.val()+"_tmpl"]:compiled_templates.noconfig_field_templ,n=o.find(".field_config_string").val(),d=t.data("type");if(o.find(".caldera-config-group").show(),t.addClass("field-initialized"),n=n.length&&d===t.val()?JSON.parse(n):fieldtype_defaults[t.val()+"_cfg"],n||(n={}),n._id=t.data("field"),n._name="config[fields]["+t.data("field")+"][config]",l=e("<div>").html(l(n)),r.html(l.html()),"function"==typeof window[t.val()+"_init"]&&window[t.val()+"_init"](t.data("field"),r),fieldtype_defaults[t.val()+"_nosupport"]&&(fieldtype_defaults[t.val()+"_nosupport"].indexOf("hide_label")>=0&&o.find(".hide-label-field").hide().find(".field-config").prop("checked",!1),fieldtype_defaults[t.val()+"_nosupport"].indexOf("caption")>=0&&o.find(".caption-field").hide().find(".field-config").val(""),fieldtype_defaults[t.val()+"_nosupport"].indexOf("required")>=0&&o.find(".required-field").hide().find(".field-config").prop("checked",!1),fieldtype_defaults[t.val()+"_nosupport"].indexOf("custom_class")>=0&&o.find(".customclass-field").hide().find(".field-config").val(""),fieldtype_defaults[t.val()+"_nosupport"].indexOf("entry_list")>=0&&o.find(".entrylist-field").hide().find(".field-config").prop("checked",!1)),o.find(".toggle_show_values").trigger("change"),!e(".caldera-select-field-type").not(".field-initialized").length){if(core_form.hasClass("builder-loaded"))i(t.data("field"));else{for(var s=e(".caldera-select-field-type.field-initialized"),c=0;c<s.length;c++)i(e(s[c]).data("field"));core_form.addClass("builder-loaded")}e(".caldera-header-save-button").prop("disabled",!1),rebuild_field_binding(),baldrickTriggers()}e(".color-field").length&&e(".color-field").wpColorPicker({change:function(a){var i=e(this);i.data("ev")&&clearTimeout(i.data("ev")),i.data("ev",setTimeout(function(){i.trigger("record")},200)),i.data("target")&&(e(i.data("target")).css(i.data("style"),i.val()),e(i.data("target")).val(i.val()))}})}function i(a){var i=e("#"+a),t=i.find(".caldera-select-field-type"),o=e('.layout-form-field[data-config="'+a+'"]'),r=o.find(".field_preview"),l=(e("#preview-"+t.val()+"_tmpl").html(),compiled_templates["preview-"+t.val()+"_tmpl"]),n={id:a},d=i.find(".field-config");d.each(function(i,t){for(var o=e(t),r=o.prop("name").split("["+a+"]")[1].substr(1),l=r.substr(0,r.length-1).split("]["),d=o.is(":checkbox,:radio")?o.filter(":checked").val():o.val(),s={},c=l.length-1;c>=0;c--)if(c===l.length-1)s[l[c]]=d;else{var p=s;s={},s[l[c]]=p}e.extend(!0,n,s)}),r.html(l(n)),o.removeClass("button"),e(".preview-field-config").prop("disabled",!0)}function t(a){var i,t=e(".caldera-editor-fields-panel"),o=(e(".caldera-editor-groups-panel"),e(".caldera-group-nav")),r=e('[data-group="'+a+'"]'),l=r.find(".caldera-config-group-name"),n=r.find(".caldera-config-group-slug"),d=r.find(".caldera-config-group-desc"),s=r.find(".caldera-config-group-admin"),c=e(".active-group-name"),p=e(".active-group-slug"),f=e(".active-group-desc"),u=e(".active-group-admin"),g=e(".caldera-editor-fields-list ul"),v=r.find(".caldera-config-group-repeat"),h=e(".repeat-config-button"),m=(e(".caldera-editor-group-settings"),e(".caldera-config-group-remove"));e(".new-group-input").remove(),e(".new-field-input").remove(),o.removeClass("active"),t.show(),g.hide(),g.removeClass("active").find("li.active").removeClass("active"),g.hide(),r.addClass("active"),i=e(".caldera-editor-fields-list ul.active li"),i.length?m.hide():m.show(),e(".caldera-editor-field-config-wrapper").hide(),r.show(),c.val(l.val()),p.val(n.val()),f.val(d.val()),"1"===s.val()?u.prop("checked",!0):u.prop("checked",!1),"1"===v.val()?h.addClass("field-edit-open"):h.removeClass("field-edit-open")}e(".caldera-header-save-button").baldrick({method:"POST",request:"admin.php?page=caldera-forms",before:function(a,i){if(i.preventDefault(),!check_required_bindings())return!1;e("#save_indicator").addClass("loading"),"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave();var t=e(".caldera-forms-options-form").formJSON();return t.conditions&&(t.config.conditional_groups={conditions:t.conditions}),e(a).data("cf_edit_nonce",t.cf_edit_nonce),e(a).data("_wp_http_referer",t._wp_http_referer),e(a).data("sender","ajax"),e(a).data("config",JSON.stringify(t.config)),!0},callback:function(a){if(!1===a.data){var i=e(".updated_notice_box");i.stop().animate({top:0},200,function(){setTimeout(function(){i.stop().animate({top:-75},200)},2e3)})}},complete:function(a){e(".wrapper-instance-pane .field-config").prop("disabled",!1)}}),e("body").on("click",".toggle_processor_event input",function(a){var i=e(this),t=i.closest(".wrapper-instance-pane"),o=t.find(".caldera-config-processor-setup"),r=t.find(".caldera-config-processor-notice");i.is(":checked")?(i.parent().addClass("activated"),i.parent().find(".is_active").show(),i.parent().find(".not_active").hide()):(i.parent().removeClass("activated"),i.parent().find(".is_active").hide(),i.parent().find(".not_active").show()),t.find(".toggle_processor_event .activated").length?(o.slideDown(100),r.slideUp(100)):(o.slideUp(100),r.slideDown(100))}),e("body").on("click",".toggle_option_tab > a",function(a){a.preventDefault();var i=e(this),t=e(i.attr("href")),o=i.parent().find("a"),r=i.closest(".caldera-editor-config-wrapper").find(".wrapper-instance-pane");o.removeClass("button-primary"),r.hide(),t.show(),i.addClass("button-primary"),e(".caldera-conditionals-usetype").trigger("change")}),e(".caldera-editor-body").on("change",".caldera-select-field-type",function(e){a(this)}),e(".caldera-editor-body").on("click",".caldera-group-nav a",function(a){a.preventDefault(),t(e(this).attr("href").substr(1))}),e(".caldera-editor-body").on("click",".caldera-editor-fields-list a",function(a){a.preventDefault();var i=e(this),t=e(i.attr("href"));e(".new-group-input").remove(),e(".new-field-input").remove(),e(".caldera-editor-fields-list li.active").removeClass("active"),i.parent().addClass("active"),e(".caldera-editor-field-config-wrapper").hide(),t.show()}),e(".caldera-editor-body").on("click",".group-config-button",function(a){var i=e(this),t=e(".caldera-editor-group-settings"),o=i.closest(".caldera-editor-fields-panel"),r=e(".caldera-config-group-remove");o.find(".caldera-field-line").length?r.hide():r.show(),i.hasClass("field-edit-open")?(t.slideUp(100),i.removeClass("field-edit-open")):(t.slideDown(100),i.addClass("field-edit-open"))}),e(".caldera-editor-body").on("keydown",".field-config",function(a){e(this).is("textarea")||13===a.which&&a.preventDefault()}),e(".caldera-editor-body").on("change",".field-label",function(a){var i=e(this).closest(".caldera-editor-field-config-wrapper").prop("id");field_line=e('[data-field="'+i+'"]'),field_title=e("#"+i+" .caldera-editor-field-title, .layout-form-field.field-edit-open .layout_field_name"),slug=e("#"+i+" .field-slug"),field_line.find("a").html('<i class="icn-field"></i> '+this.value),field_title.text(this.value),"change"===a.type&&slug.trigger("change"),rebuild_field_binding()}),e(".caldera-editor-body").on("change",".active-group-name",function(a){a.preventDefault();var i=e(".caldera-group-nav.active"),t=(i.data("group"),i.find(".caldera-config-group-name")),o=i.find("span");"focusout"!==a.type||this.value.length||(this.value="Group "+(parseInt(i.index())+1)),t.val(this.value),o.text(this.value)}),e(".caldera-editor-body").on("change",".active-group-slug",function(a){a.preventDefault();var i=e(".caldera-group-nav.active"),t=(i.data("group"),i.find(".caldera-config-group-name").val()),o=i.find(".caldera-config-group-slug"),r=(i.find("span"),this.value.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase());"focusout"!==a.type||this.value.length||(r=t.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase()),o.val(r),this.value=r}),e(".caldera-editor-body").on("change",".active-group-desc",function(a){a.preventDefault();var i=e(".caldera-group-nav.active"),t=(i.data("group"),i.find(".caldera-config-group-desc"));t.val(this.value)}),e(".caldera-editor-body").on("change",".active-group-admin",function(a){a.preventDefault();var i=e(".caldera-group-nav.active"),t=(i.data("group"),i.find(".caldera-config-group-name").val(),i.find(".caldera-config-group-admin"));i.find("span"),this.value.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase();e(this).prop("checked")?(t.val(1),i.addClass("is-admin")):(t.val(0),i.removeClass("is-admin"))}),e(".caldera-editor-body").on("click",".repeat-config-button",function(a){a.preventDefault();var i=e(".caldera-group-nav.active"),t=(i.data("group"),i.find("a .group-type")),o=i.find(".caldera-config-group-repeat"),r=e(this);r.hasClass("field-edit-open")?(o.val("0"),t.removeClass("icn-repeat").addClass("icn-folder"),r.removeClass("field-edit-open")):(o.val("1"),t.addClass("icn-repeat").removeClass("icn-folder"),r.addClass("field-edit-open"))}),e(".caldera-editor-body").on("click",".delete-field",function(){var a=e(this),i=a.closest(".caldera-editor-field-config-wrapper").prop("id");confirm(a.data("confirm"))&&(e("#"+i).remove(),e('option[value="'+i+'"]').remove(),e('[data-bind="'+i+'"]').remove(),delete current_form_fields[i],e('[data-config="'+i+'"]').slideUp(200,function(){var a=e(this);a.remove(),rebuild_field_binding(),e(document).trigger("field.removed")}))}),e(".caldera-editor-body").on("click",".add-new-group,.add-field",function(){var a=e(this);if(e(".new-group-input").remove(),e(".new-field-input").remove(),a.hasClass("add-field")){var i=e('<input type="text" class="new-field-input block-input">');i.appendTo(e(".caldera-editor-fields-list ul.active")).focus()}else{var t=e('<input type="text" class="new-group-input block-input">');t.appendTo(e(".caldera-editor-groups-panel")).focus()}}),e(".caldera-editor-body").on("change keypress",".new-group-input",function(a){if("keypress"===a.type){if(13!==a.which)return;a.preventDefault()}var i,o,r=this.value,l=e(this),n=e(".caldera-editor-groups-panel ul"),d=e(".caldera-editor-fields-list");if(r.length){i=Handlebars.compile(e("#caldera_group_line_templ").html()),o={id:r.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),name:r},n.append(i(o));var s=e('<ul data-group="'+o.id+'">').hide();s.appendTo(d),l.remove(),t(o.id)}else l.remove()}),e(".caldera-editor-body").on("change keypress",".new-field-input",function(a){if("keypress"===a.type){if(13!==a.which)return;a.preventDefault()}var i,t,o,r=this.value,l=e(this),n=l.parent(),d=e(".caldera-editor-field-config"),s=e(".caldera-config-group-remove");if(r.length){s.hide(),i=Handlebars.compile(e("#caldera_field_line_templ").html()),t=Handlebars.compile(e("#caldera_field_config_wrapper_templ").html()),o={id:r.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),label:r,slug:r.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase(),group:e(".caldera-group-nav.active").data("group")};var c=e(i(o));c.appendTo(n),d.append(t(o)),c.find("a").trigger("click"),l.remove()}else l.remove()}),e(".caldera-editor-body").on("change",".field-slug",function(a){this.value.length?this.value=this.value.split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase():"change"===a.type&&(this.value=e(this).closest(".caldera-editor-field-config-wrapper").find(".field-label").val().split(" ").join("_").split("-").join("_").replace(/[^a-z0-9_]/gi,"").toLowerCase())}),e(".caldera-editor-body").on("click",".caldera-add-group",function(a){var i=e(this),t=i.data("group"),o=e("#"+t+"_panel_tmpl").html();i.parent().parent().append(o)}),e(".caldera-editor-body").on("click",".caldera-config-group-remove",function(a){var i=e(".active-group-slug").val();e('[data-group="'+i+'"]').hide(0,function(){e(this).remove();var a=e(".caldera-group-nav");a.length?a.first().find("a").trigger("click"):e(".caldera-editor-fields-panel").hide()})}),e("body").on("click",".set-current-field",function(a){a.preventDefault();var i=e(this);e("#"+i.data("field")+"_type").val(i.data("type")).trigger("change"),e("#"+i.data("field")+"_lable").focus(),e("#field_setup_baldrickModalCloser").trigger("click")}),e(".caldera-editor-body").on("change record",".field-config",function(a){var t=e(this),o=t.closest(".caldera-editor-field-config-wrapper");current_form_fields&&(t.prop("id")===o.prop("id")+"_lable"&&(current_form_fields[o.prop("id")].label=this.value),t.prop("id")===o.prop("id")+"_slug"&&(current_form_fields[o.prop("id")].slug=this.value),t.prop("id")===o.prop("id")+"_type"&&(current_form_fields[o.prop("id")].type=this.value),o.length&&i(o.prop("id")))}),e(".caldera-editor-body").on("focus",".caldera-field-bind",function(a){var i=e(this),t=this.value;return a.type&&"focusin"===a.type?(i.removeClass("bound_field").addClass("reload-binding"),rebind_field_bindings(),void(this.value=t)):void 0}),e(".caldera-editor-body").on("change",".caldera-conditional-field-set",function(a){var i,t,o=e(this),r=o.parent().find(".compare-type"),l=o.data("condition"),n=o.data("id"),d="config["+l+"]["+n+"][conditions][group]["+o.data("row")+"]["+o.data("line")+"]",s=o.data("line"),c=e("#"+s+"_value"),p=c.find(".caldera-conditional-value-field").first(),f=[],u=this.value;if("{"!==u.substr(0,1)&&(i=e("#"+u),t=i.find(".field-button-type"),f=i.find(".caldera-config-group-toggle-options")),o.hasClass(".bind_init")&&o.addClass("bound_triggered"),p.length&&p.val().length&&c.data("value",p.val()),r.show(),f.length){var g=f.find(".toggle_option_row"),v='<select name="'+d+'[value]" class="caldera-processor-value-bind caldera-conditional-value-field" data-field="'+u+'" style="max-width: 220px; width: 220px;">';v+='<option value=""></option>',g.each(function(a,i){var t=e(i).find(".toggle_label_field"),o=t.data("option"),r="";c.data("value")&&(c.data("value").toString()!==o&&c.data("value").toString()!==e(i).find(".toggle_value_field").val()||(r=' selected="selected"')),v+='<option value="'+o+'"'+r+">"+t.val()+"</option>"}),v+="</select>"}else t&&"button"==t.val()?(r.val("is").hide(),v='<select name="'+d+'[value]" class="caldera-processor-value-bind caldera-conditional-value-field" data-field="'+u+'" style="max-width: 220px; width: 220px;">',v+='<option value="click" '+("click"===c.data("value")?'selected="selected"':"")+">Click</option>",v+='<option value="dblclick" '+("dblclick"===c.data("value")?'selected="selected"':"")+">Double Click</option>",v+="</select>"):v='<input name="'+d+'[value]" type="text" class="caldera-conditional-value-field magic-tag-enabled" value="'+(c.data("value")?c.data("value"):"")+'" style="max-width: 205px;">';c.html(v),init_magic_tags()}),e(".caldera-editor-body").on("change",".caldera-conditionals-usetype",function(a){var i=e(this);"show"===this.value||"hide"===this.value||"disable"===this.value||"use"===this.value||"not"===this.value?(e("#"+i.data("id")+"_condition_group_add").show(),e("#"+i.data("id")+"_conditional_wrap").show()):(e("#"+i.data("id")+"_condition_group_add").hide(),e("#"+i.data("id")+"_conditional_wrap").hide())}),e(".caldera-editor-body").on("click",".remove-conditional-line",function(a){a.preventDefault();var i=e(this),t=i.closest(".caldera-condition-line"),o=i.closest(".caldera-condition-group");t.remove(),o.find(".caldera-condition-line").length||o.remove()}),e(".caldera-group-nav").first().find("a").trigger("click"),e(".caldera-editor-body").on("change",".toggle_show_values",function(a){var i=e(this),t=i.closest(".caldera-config-group-toggle-options");values=t.find(".toggle_value_field"),lables=t.find(".toggle_label_field"),field_lables=t.find(".caldera-config-group-option-labels"),i.prop("checked")?(values.show().parent().show(),values.show().parent().parent().show(),lables.css("width",""),field_lables.show()):(values.hide().parent().hide(),lables.css("width",245),field_lables.hide()),lables.trigger("toggle.values"),init_magic_tags()}),e(".caldera-editor-body").on("change",".auto-populate-type",function(){e(this).closest(".wrapper-instance-pane").find(".auto-populate-options").trigger("change")}),e(".caldera-editor-body").on("change",".auto-populate-options",function(){var a=e(this),i=a.closest(".wrapper-instance-pane"),t=i.find(".caldera-config-group-toggle-options"),o=i.find(".caldera-config-group-auto-options"),r=o.find(".auto-populate-type");o.find(".auto-populate-type-panel").hide(),a.prop("checked")?(t.hide(),o.show()):(t.show(),o.hide()),o.find(".caldera-config-group-auto-"+r.val()).show()}),e("body").on("change",".pin-toggle-roles",function(){var a=e(this),i=e("#caldera-pin-rules");"1"===a.val()?i.show():i.hide()}),e("body").on("click",".magic-tag-init",function(a){var i=e(this),t=i.prev();t.focus().trigger("init.magic")}),e("body").on("keyup blur focus select click init.magic",".magic-tag-enabled",function(a){init_magic_tags();var i=e(this),t=i.parent(),o=t.closest(".wrapper-instance-pane").find(".caldera-select-field-type").val()?t.closest(".wrapper-instance-pane").find(".caldera-select-field-type").val():"hidden",r=t.find(".magic-tags-autocomplete"),l=r.find("ul"),n=this.value,d=[],s="",c=this.selectionStart,p=this.selectionEnd;if(r.length&&r.data("focus"))return void a.preventDefault();if(i.data("tag",""),this.selectionEnd>this.selectionStart)s=this.value.substr(this.selectionStart,this.selectionEnd-this.selectionStart);else if(("select"===a.type||"keyup"===a.type)&&40!==a.which&&38!==a.which&&39!==a.which&&37!==a.which){for(c=this.selectionStart;c>0;c--){var f=n.substr(c-1,1);if(" "===f||"\n"===f||("%"===f||"}"===f)&&this.selectionStart===c)break}for(p=this.selectionStart;p<n.length;p++){var f=n.substr(p,1);if(" "===f||"\n"===f||("%"===f||"{"===f)&&this.selectionStart===p)break}s=n.substr(c,p-c)}if("focusout"!==a.type){if("init"!==a.type&&s.length<3)return void(r.length&&r.remove());r.length||(r=e('<div class="magic-tags-autocomplete"></div>'),l=e("<ul></ul>"),l.appendTo(r),r.insertAfter(i),r.on("mouseenter",function(){e(this).data("focus",!0)}),r.on("mouseleave",function(){e(this).data("focus",!1),i.is(":focus")||i.trigger("focusout")})),l.empty();var u="system",g=!1;"hidden"===o||"dropdown"===o||"radio"===o||"toggle_switch"===o||"checkbox"===o?(g=!0,o="text",u="all"):"paragraph"!==o&&"html"!==o||(o="text"),i.data("type")&&(o=i.data("type")),o=o.split(","),o.push("vars");for(var v=0;v<o.length;v++)for(var h in system_values)if("undefined"!=typeof system_values[h].tags[o[v]]){if(d=[h],"system"!==h&&"variable"!==h&&"field"!==h){var m=jQuery(".processor-"+h),_=i.closest(".caldera-editor-processor-config-wrapper"),y=_.prop("id");d=[];for(var b=0;b<m.length;b++)if(_.length||g!==!0){if(y===m[b].id)continue;jQuery("li."+m[b].id).index()<jQuery("li."+y).index()&&d.push(m[b].id)}else d.push(m[b].id)}for(var w=0;w<d.length;w++)if("all"===u||u===h||"variable"===h){var k=e('<li class="header">'+system_values[h].type+(w>0?" ["+(w+1)+"]":"")+"</li>"),C=0;k.appendTo(l);for(var j=0;j<system_values[h].tags[o[v]].length;j++)if(!i.data("parent")||"variable:"+i.data("parent")!==system_values[h].tags[o[v]][j]){var x=system_values[h].wrap[0]+system_values[h].tags[o[v]][j]+system_values[h].wrap[1];if(d[w]!==h&&d.length>1&&(x=system_values[h].wrap[0]+system_values[h].tags[o[v]][j]+":"+d[w]+system_values[h].wrap[1]),x.indexOf(s)>=0||"init"===a.type){C+=1;var Q=x.replace(s,"<strong>"+s+"</strong>"),q=e('<li class="tag" data-tag="'+x+'">'+Q+"</li>");q.on("click",function(){var a=e(this).data("tag");i.val(n.substr(0,c)+a+n.substr(p)).trigger("change").focus(),i[0].selectionStart=c+a.length-(a.indexOf("*")>0?2:0),i[0].selectionEnd=c+a.length-(a.indexOf("*")>0?1:0),p=c=i[0].selectionEnd,n+=a,i.trigger("init.magic")}),q.appendTo(l)}}0===C&&k.remove()}}}l.children().length||r.remove(),"focusout"===a.type&&setTimeout(function(){r.remove()},200)});for(var o=e(".cf-editor-template"),r=0;r<o.length;r++)compiled_templates[o[r].id]=Handlebars.compile(o[r].innerHTML);e(".caldera-select-field-type").not(".field-initialized").each(function(e,i){a(i)})});var rebuild_field_binding,rebind_field_bindings,current_form_fields={},required_errors={},add_new_grid_page,add_page_grid,init_magic_tags,core_form,compiled_templates={};init_magic_tags=function(){var e=jQuery(".magic-tag-enabled");e.each(function(e,a){var i=jQuery(a);if(i.hasClass("magic-tag-init-bound")){var t=i.parent().find(".magic-tag-init");return void(i.is(":visible")?t.show():t.hide())}var o=jQuery('<span class="icn-code magic-tag-init"></span>'),r=jQuery('<span style="position:relative;display:inline-block; width:100%;"></span>');i.is("input")&&o.css("borderBottom","none"),i.hasClass("caldera-conditional-value-field")&&r.width("auto"),i.wrap(r),o.insertAfter(i),i.addClass("magic-tag-init-bound"),i.is(":visible")?o.show():o.hide()})},rebuild_field_binding=function(){if(core_form||(core_form=jQuery(".caldera-forms-options-form")),core_form.hasClass("builder-loaded")){var e=jQuery(".caldera-editor-field-config-wrapper");system_values.field={tags:{text:[]},type:"Fields",wrap:["%","%"]};for(var a=0;a<e.length;a++){var i=e[a].id,t=jQuery("#"+i+"_lable").val(),o=jQuery("#"+i+"_slug").val(),r=jQuery("#"+i+"_type").val();"undefined"==typeof system_values.field.tags[r]&&(system_values.field.tags[r]=[]),system_values.field.tags[r].push(o),"text"!==r&&system_values.field.tags.text.push(o),current_form_fields[i]={label:t,slug:o,type:r},jQuery("option.bound-field").trigger("change").each(function(e,a){var i=jQuery(a);0!==i.prop("value").indexOf("{")?i.text(jQuery("#"+i.prop("value")+"_lable").val()+" ["+jQuery("#"+i.prop("value")+"_lable").val()+"]"):i.text(i.prop("value").replace("{","").replace("}",""))}).removeClass("bound-field")}}},rebind_field_bindings=function(){var e,a,i=jQuery(".caldera-field-bind").not(".bound_field");if(i.length){i.addClass("bound_field");for(var t=0;t<i.length;t++){var o=jQuery(i[t]),r=o.val(),l=o.data("default"),n=o.data("exclude"),d=0,s=o.closest(".caldera-editor-processor-config-wrapper"),c=s.prop("id"),p="";if(l&&!o.hasClass("reload-binding")&&(r=l),o.is("select")){o.empty();var f=jQuery('<optgroup label="Fields">');for(var u in current_form_fields)o.data("type")&&o.data("type").split(",").indexOf(current_form_fields[u].type)<0||(o.data("id")!==u&&f.append('<option value="'+u+'"'+(r===u?'selected="selected"':"")+">"+current_form_fields[u].label+" ["+current_form_fields[u].slug+"]</option>"),d+=1);f.appendTo(o),0===d&&o.empty();for(var g in system_values)if(e=[],!(n&&n.split(",").indexOf(g)>=0)){if("system"!==g&&"variable"!==g)for(var v=jQuery(".processor-"+g),h=0;h<v.length;h++)c!==v[h].id&&(e.push(v[h].id),v.length>1&&(a=jQuery("li."+v[h].id+" .processor-line-number"))&&a.html("["+(h+1)+"]"));else e.push("__system__");var m=[];o.data("type")?(m=o.data("type").split(","),m.push("vars")):m=["text","vars"];for(var _=0;_<m.length;_++)if(system_values[g].tags&&system_values[g].tags[m[_]])for(var y=0;y<e.length;y++){jQuery("li."+e[y]).index()>jQuery("li."+c).index()&&"__system__"!==e[y]?o.closest(".caldera-editor-processors-panel-wrap").length&&(p=' disabled="disabled"'):p="";for(var f=jQuery('<optgroup label="'+system_values[g].type+("__system__"!==e[y]?" "+jQuery("li."+e[y]).find(".processor-line-number").html():"")+'"'+p+">"),b=0;b<system_values[g].tags[m[_]].length;b++){var w=system_values[g].tags[m[_]][b];"__system__"!==e[y]&&(w=w.replace(g,e[y])),f.append('<option value="{'+w+'}"'+(r==="{"+w+"}"?'selected="selected"':"")+p+">"+system_values[g].tags[m[_]][b]+"</option>"),d+=1}f.children().length&&f.appendTo(o)}}if(0===d){if(o.empty(),o.data("type")){o.append('<option value="">No '+o.data("type").split(",").join(" or ")+" in form</option>");var k=!0}}else o.prop("disabled",!1);o.hasClass("required")||"undefined"!=typeof k||o.prepend('<option value=""></option>'),o.val(r)}}init_magic_tags(),jQuery(document).trigger("bound.fields"),jQuery(".caldera-header-save-button").prop("disabled",!1)}},jQuery(document).ready(function(e){function a(){var a=e(".layout-grid-panel"),i=0;a.each(function(a,t){var o=e(t),r=o.find(".layout-structure"),l=o.find(".row"),n=[];l.each(function(a,t){var o=e(t),r=o.children().not(".column-merge"),l=[];i+=1,r.each(function(a,t){span=e(t).attr("class").split("-"),l.push(span[2]);var o=e(t).find(".field-location");o.length&&o.each(function(t,o){var r=e(o);r.val(i+":"+(a+1)).removeAttr("disabled")})}),n.push(l.join(":"))}),r.val(n.join("|"))})}function i(a,i,o){var r,l,n="fld_"+Math.round(1e7*Math.random()),d=n,s=e("#field_config_panels");a.prop("id","").prop("title",""),r=Handlebars.compile(e("#caldera_field_config_wrapper_templ").html()),l=e.extend({},{id:d,label:"",slug:""},o),l.slug="",s.append(r(l)),a.removeClass("button-small").removeClass("button").removeClass("button-primary").removeClass("ui-draggable").removeClass("layout-new-form-field").addClass("layout-form-field").attr("data-config",n).css({display:"",opacity:""}),a.find(".layout_field_name").remove(),a.find(".field-location").prop("name","config[layout_grid][fields]["+n+"]"),a.find(".settings-panel").show(),a.appendTo(i),t(),a.find(".icon-edit").trigger("click"),e("#"+n+"_lable").focus().select(),baldrickTriggers(),e(document).trigger("field.added"),o?e("#"+d+"_type").data("type",l.type).trigger("change"):e("#"+n).trigger("field.drop"),rebuild_field_binding()}function t(){e(".toggle-options").sortable({handle:".dashicons-sort"}),e("#grid-pages-panel").sortable({placeholder:"row-drop-helper",handle:".sort-handle",items:".first-row-level",axis:"y",stop:function(){a()}}),e(".layout-column").sortable({connectWith:".layout-column",appendTo:"#grid-pages-panel",helper:"clone",items:".layout-form-field",handle:".drag-handle",cursor:"move",opacity:.7,cursorAt:{left:100,top:15},start:function(e,a){a.helper.css({width:"200px",height:"35px",paddingTop:"20px"})},stop:function(e,i){i.item.removeAttr("style"),a()}}),e("h3 .layout-new-form-field").draggable({helper:"clone",appendTo:"body"}),e(".page-toggle.button").droppable({accept:".layout-form-field",over:function(a,i){e(this).trigger("click"),e(".layout-column").sortable("refresh")}}),e(".layout-column").droppable({greedy:!0,activeClass:"ui-state-dropper",hoverClass:"ui-state-hoverable",accept:".layout-new-form-field",drop:function(a,t){var o=t.draggable.clone(),r=e(this);i(o,r)}}),a()}function o(){if(n){var a=e(".column-fieldinsert");a.length?(a.stop().fadeToggle(700),e(".layout-new-form-field").stop().fadeToggle(700)):cf_clear_puler()}}function r(){e(".caldera-editor-processors-panel ul").sortable({update:function(){rebuild_field_binding()}})}function l(a){var i=e(a),t=e("#"+i.val()+"-tmpl").length?e("#"+i.val()+"-tmpl").html():"",o=i.closest(".caldera-editor-processor-config-wrapper"),r=o.find(".caldera-config-processor-setup"),l=Handlebars.compile(t),n=o.find(".processor_config_string").val(),d=i.data("type");n=n.length&&d===i.val()?JSON.parse(n):processor_defaults[i.val()+"_cfg"],n||(n={}),n._id=o.prop("id"),n._name="config[processors]["+o.prop("id")+"][config]",l=e("<div>").html(l(n)),r.html(l.html()),"function"==typeof window[i.val()+"_init"]&&window[i.val()+"_init"](o.prop("id"),r),o.find(".no-conditions").length&&o.find(".toggle_option_tab").remove(),rebuild_field_binding(),baldrickTriggers(),e(".wp-baldrick").baldrick({request:ajaxurl,method:"POST",before:function(a){var i=e(a);i.data("addNode")&&!i.data("request")&&i.data("request","cf_get_default_setting")}})}add_new_grid_page=function(e){return{page_no:"pg_"+Math.round(1e7*Math.random())}},add_page_grid=function(a){var i=e(".page-toggle").length+1,o=e('<button type="button" data-name="Page '+i+'" data-page="'+a.rawData.page_no+'" class="page-toggle button">'+a.params.trigger.data("addtitle")+" "+i+"</button> "),r=e("#page-toggles");o.appendTo(r),r.show(),t(),o.trigger("click"),1===i&&r.hide(),e(document).trigger("add.page")},e(document).on("remove.page add.page load.page",function(a){var i=e(".page-toggle").length,t=e("#tab_pages");1>=i?t.hide():t.show()}),t(),e("#grid-pages-panel").on("click",".column-fieldinsert .dashicons-plus-alt",function(a){var t=e(this).closest(".column-container"),o=e("#newfield-tool").clone().css("display","");i(o,t)}),e("#grid-pages-panel").on("click",".column-split",function(a){var i=e(this).parent().parent(),o=i.attr("class").split("-"),r=e("<div>").insertAfter(i),l=Math.ceil(o[2]/2),n=Math.floor(o[2]/2);o[2]=l,i.attr("class",o.join("-")),o[2]=n,r.addClass(o.join("-")).append('<div class="layout-column column-container">'),e(this).remove(),t(),jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),e("#grid-pages-panel").on("click",".column-remove",function(i){var t=e(this).closest(".row"),o=t.find(".layout-form-field"),r=t.closest(".layout-grid-panel");if(o.length){if(!confirm(e("#row-remove-fields-message").text()))return;o.each(function(a,i){var t=e(i).data("config");e("#"+t).remove(),e('option[value="'+t+'"]').remove(),e('[data-bind="'+t+'"]').remove(),delete current_form_fields[t]})}t.slideUp(200,function(){if(e(this).remove(),a(),rebuild_field_binding(),!r.find(".row").length){r.remove();var i=e("#page-toggles .button-primary"),t=i.prev(),o=i.next();i.remove(),
t.length?t.trigger("click"):o.trigger("click")}e(document).trigger("remove.page")}),jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),e(".caldera-config-editor-main-panel").on("click",".caldera-add-row",function(i){i.preventDefault();var o=e(".page-active");if(!o.length)return void e(".caldera-add-page").trigger("click");var r=e('<div style="display:none;" class="first-row-level row"><div class="col-xs-12"><div class="layout-column column-container"></div></div></div>');e(".page-active").append(r),r.slideDown(200),t(),a()}),e("#grid-pages-panel").on("click",".column-join",function(i){var t=e(this).parent().parent().parent(),o=t.prev(),r=o.attr("class").split("-"),l=t.attr("class").split("-");r[2]=parseFloat(r[2])+parseFloat(l[2]),t.find(".layout-column").contents().appendTo(o.find(".layout-column")),o.attr("class",r.join("-")),t.remove(),a(),jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),e("#grid-pages-panel").on("mouseenter",".row",function(i){var t=jQuery(this);jQuery(".column-tools,.column-merge").remove(),t.children().children().first().append('<div class="column-remove column-tools"><i class="icon-remove"></i></div>'),t.children().children().last().append('<div class="column-sort column-tools" style="text-align:right;"><i class="dashicons dashicons-menu drag-handle sort-handle"></i></div>'),t.children().children().not(":first").prepend('<div class="column-merge"><div class="column-join column-tools"><i class="icon-join"></i></div></div>');var o=t.parent().parent().parent().width()/12-1;t.children().children().each(function(a,i){var t=e(i),o=t.width()/2-5;t.prepend('<div class="column-fieldinsert column-tools"><i class="dashicons dashicons-plus-alt"></i></div>'),t.parent().hasClass("col-xs-1")||(t.prepend('<div class="column-split column-tools"><i class="dashicons dashicons-leftright"></i></div>'),t.find(".column-split").css("left",o))}),jQuery(".column-merge").draggable({axis:"x",helper:"clone",appendTo:t,grid:[o,0],drag:function(i,t){e(this).addClass("dragging"),e(".column-tools").remove(),e(".column-split").remove();var o=e(this).parent().parent(),r=t.helper,l=t.originalPosition.left>r.position().left?"left":"right",n=o.prev(),d=Math.round(o.parent().width()/12-10),s=Math.abs(t.originalPosition.left-r.position().left);if(o.parent().addClass("sizing"),s>=d){var c=n.attr("class").split("-"),p=o.attr("class").split("-");c[2]=parseFloat(c[2]),p[2]=parseFloat(p[2]),"left"===l?(c[2]--,p[2]++,c[2]>0&&c[2]<c[2]+p[2]?(n.attr("class",c.join("-")),o.attr("class",p.join("-")),t.originalPosition.left=r.position().left):e(this).draggable("option","disabled",!0)):(c[2]++,p[2]--,p[2]>0&&p[2]<p[2]+p[2]?(n.attr("class",c.join("-")),o.attr("class",p.join("-")),t.originalPosition.left=r.position().left):e(this).draggable("option","disabled",!0)),a()}},stop:function(){e(this).removeClass("dragging").parent().parent().parent().removeClass("sizing")}})}),e("#grid-pages-panel").on("mouseleave",".row",function(e){jQuery(".column-tools").remove(),jQuery(".column-merge").remove()}),e("#grid-pages-panel").on("click",".layout-form-field .icon-remove",function(){var a=e(this),i=a.parent(),t=e("#"+i.data("config"));i.slideUp(100,function(){e(this).remove()}),t.slideUp(100,function(){e(this).remove()})}),e(document).on("click",".layout-form-field .dashicons-admin-page",function(){var a=e(this),t=a.parent(),o=t.data("config"),r=e("#"+o).formJSON(),l=a.closest(".column-container"),n=t.clone().css("display",""),d={};t.hasClass("field-edit-open")&&(t.removeClass("field-edit-open"),n.removeClass("field-edit-open"),e(".caldera-editor-field-config-wrapper").hide()),r.config.fields[o]&&(d=r.config.fields[o],delete d.ID),i(n,l,d)}),e(document).on("click",".layout-form-field .icon-edit",function(){var a=e(this),i=a.parent(),t=e("#"+i.data("config")+"_type").val();e(".caldera-editor-field-config-wrapper").hide(),i.hasClass("field-edit-open")?i.removeClass("field-edit-open"):(e(".layout-form-field").removeClass("field-edit-open"),i.addClass("field-edit-open"),e("#"+i.data("config")).show()),e(document).trigger("show."+i.data("config")),e(document).trigger("show.fieldedit"),"radio"!==t&&"checkbox"!==t&&"dropdown"!==t&&"toggle_switch"!==t||e("#"+i.data("config")+"_auto").trigger("change")}),e("body").on("click",".layout-modal-edit-closer,.layout-modal-save-action",function(a){a.preventDefault();var i=e(this),t=e(".layout-form-field.edit-open"),o=i.closest(".layout-modal-container");settings=o.find(".settings-panel").first(),e(".edit-open").removeClass("edit-open"),settings.appendTo(t.find(".settings-wrapper")).hide(),o.hide()}),e(".layout-editor-body").on("change",".layout-core-pod-query",function(){e(this).parent().find(".settings-panel-row").remove(),e(".edit-open").find(".drag-handle .set-pod").html(" - "+e(this).val())}),e(".layout-editor-body").on("click",".remove-where",function(){e(this).closest(".settings-panel-row").remove()}),e(".layout-editor-body").on("click",".use-pod-container",function(){var a=e(this),i=a.prev(),t=i.val();if(t.length){e(".edit-open").find(".drag-handle .set-pod").html(" - "+i.val()),a.parent().parent().find(".spinner").css("display","inline-block");var o={action:"pq_loadpod",pod_reference:{pod:t}};e.post(ajaxurl,o,function(i){a.parent().find(".spinner").css("display","none");var t=e("#where-line-tmpl").html(),o="",r=a.closest(".settings-panel").data("container");for(var l in i)o+='<option value="'+i[l]+'">'+i[l]+"</option>";t=t.replace(/{{fields}}/g,o).replace(/{{container_id}}/g,r),a.parent().append(t)})}}),e(".caldera-editor-header").on("click",".column-sort .icon-edit",function(e){}),e(".layout-editor-body").on("tray_loaded",".layout-template-tray",function(){t()}),e(".caldera-editor-header").on("click",".caldera-editor-header-nav a",function(a){a.preventDefault();var i=e(this);e(".caldera-editor-header-nav li").removeClass("active"),e(".caldera-editor-body").hide(),e(i.attr("href")).show(),i.parent().addClass("active"),rebind_field_bindings()}),e("body").on("change",".required",function(){check_required_bindings(this)}),e("body").on("submit",".caldera-forms-options-form",function(a){var i=e(".required.has-error");i.length&&a.preventDefault()}),e(".caldera-editor-body").on("click",".add-toggle-option",function(a){var i=e(this);if(i.data("bulk"))return e(i.data("bulk")).toggle(),void e(i.data("bulk")).find("textarea").focus();var t=i.closest(".caldera-editor-field-config-wrapper"),o=t.find(".toggle-options"),r=e("#field-option-row-tmpl").html(),l=Handlebars.compile(r),n="opt"+parseInt(1048576*(Math.random()+1)),d={_name:"config[fields]["+t.prop("id")+"][config]",option:{}};if(i.data("options")){for(var s=e(i.data("options")),c=s.val().split("\n"),p=!1,f=0;f<c.length;f++){var u=c[f],g=u,v=g.split("|");v.length>1&&(g=v[0],u=v[1],p=!0),d.option["opt"+parseInt(1048576*(Math.random()+f))]={value:g,label:u,"default":!1}}e(i.data("options")).parent().hide(),s.val(""),!0===p?t.find(".toggle_show_values").prop("checked",!0):t.find(".toggle_show_values").prop("checked",!1),o.empty()}else d.option[n]={value:"",label:"","default":!1};e(".preset_options").val(""),o.append(l(d)),t.find(".toggle_show_values").trigger("change"),e(".toggle-options").sortable({handle:".dashicons-sort"}),c||o.find(".toggle_label_field").last().focus()}),e(".caldera-editor-body").on("change",".preset_options",function(a){var i=e(this),t=i.val(),o=e(i.data("bulk"));preset_options&&preset_options[t]&&preset_options[t].data&&("object"==typeof preset_options[t].data&&preset_options[t].data.length&&(preset_options[t].data=preset_options[t].data.join("\n")),o.val(preset_options[t].data))}),e(".caldera-editor-body").on("click",".toggle-remove-option",function(a){var i=e(this).closest(".caldera-editor-field-config-wrapper").find(".field-config").first();e(this).parent().remove(),i.trigger("change"),e(document).trigger("option.remove")}),e(".caldera-editor-body").on("click",".page-toggle",function(a){var i=e(this),t=i.parent(),o=t.find(".button");o.removeClass("button-primary"),e(".layout-grid-panel").hide().removeClass("page-active"),e("#"+i.data("page")).show().addClass("page-active"),i.addClass("button-primary"),o.each(function(a,i){e(i).html(t.data("title")+" "+(a+1))}),1===o.length&&t.hide()}),e(".caldera-editor-body").on("blur toggle.values",".toggle_label_field",function(a){var i=e(this),t=i.prev();t.val().length||t.val(i.val())}),e(document).on("change focusout",".toggle_value_field",function(){e(document).trigger("show.fieldedit")}),e(document).on("show.fieldedit option.remove",function(a){e(".toggle_value_field.has-error").removeClass("has-error");for(var i=e("#"+e(".layout-form-field.field-edit-open").data("config")),t=i.find(".toggle_value_field"),o=i.find(".notice"),r=0,l=0;l<t.length;l++){for(var n=(t[l].value,0),d=0;d<t.length;d++)t[l]!==t[d]&&t[l].value===t[d].value&&(e(t[d]).addClass("has-error"),n++);n>0&&(e(t[l]).addClass("has-error"),r++)}r>0?(o.slideDown(),a.preventDefault()):o.slideUp()});var n=!1;focus_initial_field=function(a){var i=e(".layout-grid-panel .icon-edit").first();i.length?i.trigger("click"):(e(".layout-column.column-container").first().trigger("mouseover"),n=setInterval(o,500)),e(document).off("load.page",focus_initial_field)},e(document).on("load.page",focus_initial_field),cf_clear_puler=function(){n&&(clearTimeout(n),e(document).off("mouseover",".layout-new-form-field, .column-fieldinsert",cf_clear_puler)),e(".layout-new-form-field, .column-fieldinsert").fadeIn()},e(document).on("mouseover",".layout-new-form-field, .column-fieldinsert",cf_clear_puler),rebuild_field_binding(),e(document).trigger("load.page"),e("body").on("click",".caldera-processor-nav a",function(a){a.preventDefault();var i=e(this);e(".caldera-processor-nav").removeClass("active"),e(".caldera-editor-processor-config-wrapper").hide(),e(i.attr("href")).show(),i.parent().addClass("active")}),e("body").on("click",".add-new-processor",function(a){var i=e(this),t=Handlebars.compile(e("#processor-wrapper-tmpl").html());wrap=e(".active-processors-list"),process_conf=e(".caldera-editor-processor-config"),processid=Math.round(1e8*Math.random()),new_templ=Handlebars.compile(e("#processor-line-tmpl").html()),new_proc={id:"fp_"+processid,type:i.data("type")},wrap.append(new_templ(new_proc)),process_conf.append(t(new_proc)),e("#form_processor_baldrickModalCloser").trigger("click"),e(".caldera-processor-nav a").last().trigger("click"),e("#fp_"+processid+"_type").val(i.data("type")).trigger("change"),r(),baldrickTriggers()}),e("body").on("click",".delete-processor",function(a){var i=e(this),t=i.closest(".caldera-editor-processor-config-wrapper");t.data("type");confirm(i.data("confirm"))&&(e("."+t.prop("id")).remove(),t.remove(),e(".caldera-processor-nav a").first().trigger("click"),rebuild_field_binding())}),e("body").on("change",".caldera-select-processor-type",function(a){var i=e(this),t=i.closest(".caldera-editor-processor-config-wrapper"),o=i.find('option[value="'+i.val()+'"]').text(),r=t.find(".caldera-editor-processor-title"),n=e(".caldera-processor-nav.active a");""===o&&(o=r.data("title")),r.html(o),n.html(o+' <span class="processor-line-number"></span>').parent().addClass("processor_type_"+i.val()),l(this),rebuild_field_binding()}),e(document).on("click","#cf-shortcode-preview",function(){e(this).focus().select()}),e(document).on("change",".cf-email-preview-toggle",function(){var a=e(this),i=e(".caldera-header-email-preview-button");a.is(":checked")?i.show().attr("aria-hidden","false").css("visibility","visible"):i.hide().attr("aria-hidden","true").css("visibility","hidden")}),rebuild_field_binding(),e(".caldera-select-processor-type").each(function(e,a){l(a)}),r()}),Handlebars.registerHelper("_field",function(e){var a=this,i="",t="",o="",r=this[e.hash.slug]?' data-default="'+this[e.hash.slug]+'"':"";e.hash.required&&(i=" required"),e.hash.exclude&&(o='data-exclude="'+e.hash.exclude+'"'),e.hash.array&&(t="[]","true"!==e.hash.array&&(r='value="'+e.hash.array+'"')),out="<select "+(e.hash.type?'data-type="'+e.hash.type+'"':"")+r+" "+o+' name="'+this._name+"["+e.hash.slug+"]"+t+'" id="'+this._id+"_"+e.hash.slug+'" class="block-input field-config caldera-field-bind'+i+'">',this[e.hash.slug]?out+='<option class="bound-field" value="'+this[e.hash.slug]+'" class="bound-field"></option>':e.hash.required||(out+='<option value=""></option>');for(var l in current_form_fields){var n="";e.hash.type&&current_form_fields[l].type!==e.hash.type||(a[e.hash.slug]&&a[e.hash.slug]===l&&(n=' selected="selected"'),out+='<option value="'+l+'"'+n+">"+current_form_fields[l].label+" ["+current_form_fields[l].slug+"]</option>")}return out+="</select>",e.hash.required&&(out+='<input class="field-config" name="'+this._name+'[_required_bounds][]" type="hidden" value="'+e.hash.slug+'">'),out}),Handlebars.registerHelper("console",function(e,a){console.log(this)});
